
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta property="og:title" content="Web Application Security with secure.py" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="posts/2020/2020-11-11-web-application-security.html" />
  <meta property="og:description" content="A common pitfall when developing web applications is not knowing how to design a safe application. secure.py is a great Python module that helps deal with the basic foundations of web application s..." />
  
    <title>Web Application Security with secure.py &#8212; Stonecharioteer&#39;s Blog</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../../../about/" />
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" /> 
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
     
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../blog/atom.xml"
  title="Stonecharioteer's Blog"
/>
 
<style type="text/css">
  ul.ablog-archive {
    list-style: none;
    overflow: auto;
    margin-left: 0px;
  }
  ul.ablog-archive li {
    float: left;
    margin-right: 5px;
    font-size: 80%;
  }
  ul.postlist a {
    font-style: italic;
  }
  ul.postlist-style-disc {
    list-style-type: disc;
  }
  ul.postlist-style-none {
    list-style-type: none;
  }
  ul.postlist-style-circle {
    list-style-type: circle;
  }
</style>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../">
  <img src="../../../_static/stonecharioteer-banner.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../">
  Stonecharioteer's Blog
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../about/">
  About Me
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../2021/personal-code/">
  Values
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../notes/">
  Notes
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../../../search/" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this site..." aria-label="Search this site..." autocomplete="off" >
</form>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/stonecharioteer/" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/stonecharioteer" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">  
<h2>
  Web Application Security with secure.py
</h2>
<hr />
<h2>
  <i class="fa fa-calendar"></i>
  Nov 11, 2020 
</h2>

<ul>
      
<li id="category">
  <span
    ><i class="fa-fw fa fa-folder-open"></i></span
  >
   
  <a href="../../../blog/category/tutorial/">Tutorial</a>  
</li>
 
<li id="tags">
  <span
    ><i class="fa-fw fa fa-tags"></i> </span
  >
   
  <a href="../../../blog/tag/python/">python</a>   
  <a href="../../../blog/tag/flask/">flask</a>   
  <a href="../../../blog/tag/security/">security</a>  
</li>
 
<li id="comments">
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = "stonecharioteer"; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
      var s = document.createElement("script");
      s.async = true;
      s.type = "text/javascript";
      s.src = "//" + disqus_shortname + ".disqus.com/count.js";
      (
        document.getElementsByTagName("HEAD")[0] ||
        document.getElementsByTagName("BODY")[0]
      ).appendChild(s);
    })();
  </script>
  <i class="fa-fw fa fa-comments"></i>
  <a
    href="#disqus_thread"
    data-disqus-identifier="/posts/2020/2020-11-11-web-application-security/"
  >
    </a
  >
</li>

</ul>

<h3>
  <a href="../../../blog/">Recent Posts</a>
</h3>
<ul>
   
  <li>
    <a href="../../2022/documentation-assumptions/"
      >16 January - Documentation Without Assumption</a
    >
  </li>
  
  <li>
    <a href="../../2022/leetcode/"
      >16 January - A System for Getting Better at Leetcode</a
    >
  </li>
  
  <li>
    <a href="../../2022/vagrant/"
      >10 January - Vagrant</a
    >
  </li>
  
  <li>
    <a href="../../2022/python/"
      >07 January - Python - A Reflection in 2022</a
    >
  </li>
  
  <li>
    <a href="../../2022/onward/"
      >03 January - Onward</a
    >
  </li>
  
</ul>

<h3><a href="../../../blog/tag/">Tags</a></h3>
<style type="text/css">
  ul.ablog-cloud {
    list-style: none;
    overflow: auto;
  }
  ul.ablog-cloud li {
    float: left;
    height: 20pt;
    line-height: 18pt;
    margin-right: 5px;
  }
  ul.ablog-cloud a {
    text-decoration: none;
    vertical-align: middle;
  }
  li.ablog-cloud-1 {
    font-size: 80%;
  }
  li.ablog-cloud-2 {
    font-size: 95%;
  }
  li.ablog-cloud-3 {
    font-size: 110%;
  }
  li.ablog-cloud-4 {
    font-size: 125%;
  }
  li.ablog-cloud-5 {
    font-size: 140%;
  }
</style>
<ul class="ablog-cloud">
   
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/advent-of-code/">Advent of Code</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/algorithms/">Algorithms</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/ansible/">Ansible</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/career-advice/">Career-Advice</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/data-structures/">Data Structures</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/developer-environment/">Developer Environment</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/developer-experience/">Developer Experience</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/developer-relations/">Developer Relations</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/development-environment/">Development Environment</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/documentation/">Documentation</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/furo/">Furo</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/goals/">Goals</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/hugo/">Hugo</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/jekyll/">Jekyll</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/learning/">Learning</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/leetcode/">Leetcode</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/life/">Life</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/meta/">Meta</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/notes/">Notes</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/oso/">Oso</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/philosophy/">Philosophy</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/programming/">Programming</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/python/">Python</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/ruby/">Ruby</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/sphinx/">Sphinx</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/teaching/">Teaching</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/tech/">Tech</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/technical-interviews/">Technical
Interviews</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/technical-interviews/">Technical Interviews</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/vagrant/">Vagrant</a>
  </li>
        
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/bangalore/">bangalore</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/bangpypers/">bangpypers</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-4">
    <a href="../../../blog/tag/bibek-debroy/">bibek-debroy</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-4">
    <a href="../../../blog/tag/books/">books</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/career/">career</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/coding/">coding</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/comics/">comics</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/computer-science/">computer-science</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/conda/">conda</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/conferences/">conferences</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/courses/">courses</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/covid/">covid</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/databases/">databases</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/discord/">discord</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/documentation/">documentation</a>
  </li>
        
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/editors/">editors</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/empathy/">empathy</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/flask/">flask</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/flipkart/">flipkart</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/gaming/">gaming</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/golang/">golang</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-4">
    <a href="../../../blog/tag/hampi/">hampi</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/health/">health</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/hearing-loss/">hearing-loss</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/hobbies/">hobbies</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/homelab/">homelab</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-4">
    <a href="../../../blog/tag/indian-mythology/">indian-mythology</a>
  </li>
        
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/iot/">iot</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/japanese/">japanese</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/jekyll/">jekyll</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/kubernetes/">kubernetes</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/learning/">learning</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/letters/">letters</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/libraries/">libraries</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/life/">life</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/linux/">linux</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/livecast/">livecast</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/mahabharata/">mahabharata</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/meetup/">meetup</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/mental-health/">mental-health</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/meta/">meta</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/micropython/">micropython</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/neovim/">neovim</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/nostalgia/">nostalgia</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/notes/">notes</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/pip/">pip</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/podcasts/">podcasts</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/programming/">programming</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/pycon/">pycon</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-2">
    <a href="../../../blog/tag/python/">python</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/raspberry-pi/">raspberry-pi</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-5">
    <a href="../../../blog/tag/reading/">reading</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/rust/">rust</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/screencast/">screencast</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/security/">security</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/shelfie/">shelfie</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/single-sided-deafness/">single-sided-deafness</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/snhl/">snhl</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/talks/">talks</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/tech/">tech</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/technology/">technology</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/thoughts/">thoughts</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/til/">til</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/tiny/">tiny</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/tutorial/">tutorial</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/updates/">updates</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/video/">video</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/videos/">videos</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/vim/">vim</a>
  </li>
      
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/webdev/">webdev</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/wfh/">wfh</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/work/">work</a>
  </li>
    
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/writing/">writing</a>
  </li>
        
  <li class="ablog-cloud ablog-cloud-1">
    <a href="../../../blog/tag/zen/">zen</a>
  </li>
   
</ul>

<h3>
  <a href="../../../blog/category/">Categories</a>
</h3>
<ul>
     
  <li>
    <a href="../../../blog/category/health/">Health (1)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/how-to/">How To (1)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/journal/">Journal (2)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/learning/">Learning (4)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/life/">Life (5)</a>
  </li>
        
  <li>
    <a href="../../../blog/category/personal/">Personal (1)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/programming/">Programming (1)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/reading/">Reading (22)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/review/">Review (2)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/show-and-tell/">Show and Tell (6)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/talks/">Talks (3)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/tech/">Tech (4)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/thoughts/">Thoughts (1)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/tips-and-tricks/">Tips and Tricks (1)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/tutorial/">Tutorial (2)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/update/">Update (3)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/updates/">Updates (3)</a>
  </li>
    
  <li>
    <a href="../../../blog/category/writing/">Writing (1)</a>
  </li>
     
</ul>

<h3>
  <a href="../../../blog/archive/">Archives</a>
</h3>
<ul>
   
  <li>
    <a href="../../../blog/2022/">2022 (5)</a>
  </li>
    
  <li>
    <a href="../../../blog/2021/">2021 (15)</a>
  </li>
    
  <li>
    <a href="../../../blog/2020/">2020 (18)</a>
  </li>
    
  <li>
    <a href="../../../blog/2019/">2019 (2)</a>
  </li>
    
  <li>
    <a href="../../../blog/2018/">2018 (2)</a>
  </li>
    
  <li>
    <a href="../../../blog/2017/">2017 (2)</a>
  </li>
    
  <li>
    <a href="../../../blog/2016/">2016 (20)</a>
  </li>
   
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goal">
   Goal
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#owasp">
   OWASP
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-little-bit-about-http-headers">
   A Little Bit About HTTP Headers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#owasp-guidelines-on-secure-headers">
   OWASP Guidelines on Secure Headers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#secure-py">
   <code class="docutils literal notranslate">
    <span class="pre">
     secure.py
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#x-powered-by">
   X-Powered-By
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#httpie">
   <code class="docutils literal notranslate">
    <span class="pre">
     httpie
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-and-additional-tools">
   References and Additional Tools
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                 <div class="section" id="web-application-security-with-secure-py">
<h1>Web Application Security with secure.py<a class="headerlink" href="#web-application-security-with-secure-py" title="Permalink to this headline">¶</a></h1>
<p>A common pitfall when developing web applications is not knowing how to design a safe application.
<code class="docutils literal notranslate"><span class="pre">secure.py</span></code> is a great Python module that helps deal with the basic foundations of web application security.</p>
<div class="section" id="goal">
<h2>Goal<a class="headerlink" href="#goal" title="Permalink to this headline">¶</a></h2>
<p>In this post, I go through web application security, and how to use <code class="docutils literal notranslate"><span class="pre">secure.py</span></code> to address
common pitfalls. Note that by web application security, I am not addressing authentication or database security.
I mean secure web headers, predominantly, as defined by the <a class="reference external" href="https://owasp.org/www-project-secure-headers/">OWASP Secure Headers Project.</a></p>
</div>
<div class="section" id="owasp">
<h2>OWASP<a class="headerlink" href="#owasp" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://owasp.org/">Open Web Application Security Project®</a> (OWASP) is a nonprofit foundation that works to improve the security of software.
It provides resources and guidelines about web application security, and holds educational and training conferences.</p>
<p>If you’re concerning yourself with writing a web application, I highly recommend going through the OWASP guidelines
on various topics related to web application security.</p>
<p>This particular post will be centered around the OWASP guidelines on HTTP Headers. Reference links are at the bottom of the post.</p>
</div>
<div class="section" id="a-little-bit-about-http-headers">
<h2>A Little Bit About HTTP Headers<a class="headerlink" href="#a-little-bit-about-http-headers" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers">HTTP Headers</a> are the sort of things that don’t <em>often</em> concern developers. We don’t think about them, until we encounter
some issue with Cross-Site Requests or something similar. However, knowledge of headers gives you a lot to think about.</p>
<p>How do you even <em>see</em> the headers, anyway?</p>
<p>Let’s try <code class="docutils literal notranslate"><span class="pre">curl</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl google.com
&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;301 Moved&lt;/H1&gt;
The document has moved
&lt;A <span class="nv">HREF</span><span class="o">=</span><span class="s2">&quot;http://www.google.com/&quot;</span>&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>Besides the HTML content, this tells us <em>nothing</em>. From the <code class="docutils literal notranslate"><span class="pre">title</span></code> tag, you can guess that the request
returned a <a class="reference external" href="https://devhints.io/http-status">301 Moved HTTP status code</a>. However, remember, developers are <em>human</em>.</p>
<p>It is only too easy to do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flask</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">textwrap</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span>
<span class="s2">    &lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;</span>
<span class="s2">    &lt;H1&gt;301 Moved&lt;/H1&gt;</span>
<span class="s2">    The document has moved</span>
<span class="s2">    &lt;A HREF=&quot;http://localhost/&quot;&gt;here&lt;/A&gt;.</span>
<span class="s2">    &lt;/BODY&gt;&lt;/HTML&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">html</span><span class="p">,</span> <span class="mi">200</span>

</pre></div>
</div>
<p>If you save that snippet to a file named <code class="docutils literal notranslate"><span class="pre">app.py</span></code>, and run it with the Flask command line using <code class="docutils literal notranslate"><span class="pre">FLASK_APP=app.py</span> <span class="pre">flask</span> <span class="pre">run</span></code>,
you can access this with <code class="docutils literal notranslate"><span class="pre">curl</span></code> again.</p>
<p>Note that you need to have a Python environment with <code class="docutils literal notranslate"><span class="pre">flask</span></code> installed for this to work.</p>
<p>PS: If you’ve noticed the <code class="docutils literal notranslate"><span class="pre">textwrap.dedent</span></code> trick, it’s a neat way of telling python to ignore the indentation within a triple-quoted string.
I can get a bit pedantic about being exact.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl localhost:5000/

&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;301 Moved&lt;/H1&gt;
The document has moved
&lt;A <span class="nv">HREF</span><span class="o">=</span><span class="s2">&quot;http://localhost/&quot;</span>&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>There’s no difference here. Does that mean both are the same?</p>
<p><em>No</em>.</p>
<p>Instead, let’s try to see if <code class="docutils literal notranslate"><span class="pre">curl</span></code> can help.</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-s</span> <span class="pre">-D</span> <span class="pre">-</span> <span class="pre">&lt;url&gt;</span></code> Will give us the entire response, including the HTTP headers.</p>
<p>Let’s try it on <code class="docutils literal notranslate"><span class="pre">google.com</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -s -D - google.com

HTTP/1.1 <span class="m">301</span> Moved Permanently
Location: http://www.google.com/
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8
Date: Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">17</span>:52:37 GMT
Expires: Fri, <span class="m">11</span> Dec <span class="m">2020</span> <span class="m">17</span>:52:37 GMT
Cache-Control: public, max-age<span class="o">=</span><span class="m">2592000</span>
Server: gws
Content-Length: <span class="m">219</span>
X-XSS-Protection: <span class="m">0</span>
X-Frame-Options: SAMEORIGIN

&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;301 Moved&lt;/H1&gt;
The document has moved
&lt;A <span class="nv">HREF</span><span class="o">=</span><span class="s2">&quot;http://www.google.com/&quot;</span>&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>The first line is the most important one. It tells us that the website we are trying to access has <em>moved permanently</em>.
In fact, the code there is the standard code for the 301 response.</p>
<p>Let’s look at what we have.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -s -D - localhost:5000/

HTTP/1.0 <span class="m">200</span> OK
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length: <span class="m">213</span>
Server: Werkzeug/1.0.1 Python/3.8.5
Date: Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">17</span>:52:41 GMT


&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;301 Moved&lt;/H1&gt;
The document has moved
&lt;A <span class="nv">HREF</span><span class="o">=</span><span class="s2">&quot;http://localhost/&quot;</span>&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>Not only does this say <code class="docutils literal notranslate"><span class="pre">HTTP/1.0</span> <span class="pre">200</span> <span class="pre">OK</span></code> when the <em>body</em> of the response says <code class="docutils literal notranslate"><span class="pre">301</span> <span class="pre">Moved</span></code>, but it also has fewer items in the header.</p>
<p>This exercise served three purposes:</p>
<ol class="simple">
<li><p>The actual response code of a HTTP request <em>does not have to match the response body</em>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-s</span> <span class="pre">-D</span> <span class="pre">-</span> <span class="pre">&lt;url&gt;</span></code> can be used to expose all the headers.</p></li>
<li><p>Despite the body being the same, the default headers of our flask app are not the same as those returned by <code class="docutils literal notranslate"><span class="pre">google.com</span></code>.</p></li>
</ol>
<p>Look at point 3 again. <strong>Despite the body being the same, the default headers of our flask app are not the same as those returned by <code class="docutils literal notranslate"><span class="pre">google.com</span></code>.</strong>.</p>
<p>In the response you get from flask, the first <em>red flag</em> should be <code class="docutils literal notranslate"><span class="pre">Server:</span> <span class="pre">Werkzeug/1.0.1</span> <span class="pre">Python/3.8.5</span></code>. Why?</p>
<p>This is telling any potential users of your API that your server is running on Werkzeug 1.0.1, using Python 3.8.5. Any malevolent user will just need to search for “vulnerabilities to exploit in Python 3.8.5” to get a list of ideas on how to bring down your app.</p>
<p>This is where we segui into the OWASP guidelines.</p>
</div>
<div class="section" id="owasp-guidelines-on-secure-headers">
<h2>OWASP Guidelines on Secure Headers<a class="headerlink" href="#owasp-guidelines-on-secure-headers" title="Permalink to this headline">¶</a></h2>
<p>Open the <a class="reference external" href="https://owasp.org/www-project-secure-headers/">OWASP Secure Headers Project</a> and click on the <code class="docutils literal notranslate"><span class="pre">Response</span> <span class="pre">Headers</span></code> Tab. This displays the following list:</p>
<ul class="simple">
<li><p>HTTP Strict Transport Security (HSTS)</p></li>
<li><p>X-Frame-Options</p></li>
<li><p>X-Content-Type-Options</p></li>
<li><p>Content-Security-Policy</p></li>
<li><p>X-Permitted-Cross-Domain-Policies</p></li>
<li><p>Referrer-Policy</p></li>
<li><p>Feature-Policy</p></li>
<li><p>Public Key Pinning Extension for HTTP (HPKP)</p></li>
<li><p>Expect-CT</p></li>
<li><p>X-XSS-Protection</p></li>
</ul>
<p>This a list of the top ten best ways to ensure secure headers in an application. The link above provides detailed explanations of what these are and why you should be aware of them.
Explaining that is out of the scope of this post.</p>
<p>However, it is important that you add these headers into your own application. While you could theoretically learn how to do that with the flask
<code class="docutils literal notranslate"><span class="pre">app.after_request</span></code> hook and manually baking in the rules into that, there’s an easier way: use <code class="docutils literal notranslate"><span class="pre">secure.py</span></code>.</p>
</div>
<div class="section" id="secure-py">
<h2><code class="docutils literal notranslate"><span class="pre">secure.py</span></code><a class="headerlink" href="#secure-py" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">secure.py</span></code> is a minimal Python library that offers a way to add secure headers by default. It is designed with the OWASP guidelines in tow, and it is constantly updated
with the best practices baked in. The best part of it is that it is a uniform library that is agnostic of your framework, so Django devs, rejoice!</p>
<p>First, install <code class="docutils literal notranslate"><span class="pre">secure.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">secure</span>

</pre></div>
</div>
<p>Then, use this in a flask app.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flask</span>
<span class="kn">from</span> <span class="nn">secure</span> <span class="kn">import</span> <span class="n">SecureHeaders</span>

<span class="n">secure_headers</span> <span class="o">=</span> <span class="n">SecureHeaders</span><span class="p">()</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">textwrap</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span>
<span class="s2">    &lt;TITLE&gt;Hello, World&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;</span>
<span class="s2">    &lt;H1&gt;Hello, World&lt;/H1&gt;</span>
<span class="s2">    &lt;P&gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quam, nisi ratione voluptatibus possimus eveniet odio iste id aperiam odit nihil provident ea a repellat consectetur repudiandae voluptas omnis placeat!&lt;/P&gt;</span>
<span class="s2">    &lt;/BODY&gt;&lt;/HTML&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">html</span><span class="p">,</span> <span class="mi">200</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">after_request</span>
<span class="k">def</span> <span class="nf">set_secure_headers</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">secure_headers</span><span class="o">.</span><span class="n">flask</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&#64;app,after_request</span></code> allows you to add additional information to the response, or remove information from it. These lines of code ensure that your application
follows the OWASP Secure Headers guidelines to a T.</p>
<p>Let’s try this out.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -s -D - localhost:5000

HTTP/1.0 <span class="m">200</span> OK
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length: <span class="m">387</span>
Strict-Transport-Security: max-age<span class="o">=</span><span class="m">63072000</span><span class="p">;</span> includeSubdomains
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: <span class="m">1</span><span class="p">;</span> <span class="nv">mode</span><span class="o">=</span>block
X-Content-Type-Options: nosniff
Referrer-Policy: no-referrer, strict-origin-when-cross-origin
Pragma: no-cache
Expires: <span class="m">0</span>
Cache-control: no-cache, no-store, must-revalidate, max-age<span class="o">=</span><span class="m">0</span>
Server: Werkzeug/1.0.1 Python/3.8.5
Date: Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">18</span>:18:38 GMT


&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;Hello, World&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;Hello, World&lt;/H1&gt;
&lt;P&gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quam, nisi ratione voluptatibus possimus eveniet odio iste id aperiam odit nihil provident ea a repellat consectetur repudiandae voluptas omnis placeat!&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>Now, you can see that a lot of additional headers have been added. These are the headers defined by the OWASP guidelines. However, <code class="docutils literal notranslate"><span class="pre">Server</span></code> is still present in the response. This is because
while it is <em>unsafe</em> to expose this information, it should be altered explicitly instead of
through a library since it may be necessary in some cases.</p>
<p>To address this, we can just add <code class="docutils literal notranslate"><span class="pre">response.headers.set(&quot;Server&quot;,</span> <span class="pre">&quot;Secure&quot;)</span></code> in the <code class="docutils literal notranslate"><span class="pre">&#64;app.after_request</span></code> function.</p>
<p>If you are interested, you may also use <code class="docutils literal notranslate"><span class="pre">SecureCookie</span></code> to add a cookie to the response.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flask</span>
<span class="kn">from</span> <span class="nn">secure</span> <span class="kn">import</span> <span class="n">SecureHeaders</span>
<span class="kn">from</span> <span class="nn">secure</span> <span class="kn">import</span> <span class="n">SecureCookie</span>

<span class="n">secure_headers</span> <span class="o">=</span> <span class="n">SecureHeaders</span><span class="p">()</span>
<span class="n">secure_cookie</span> <span class="o">=</span> <span class="n">SecureCookie</span><span class="p">(</span><span class="n">expires</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">samesite</span><span class="o">=</span><span class="n">SecureCookie</span><span class="o">.</span><span class="n">SameSite</span><span class="o">.</span><span class="n">STRICT</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="o">.</span><span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="kn">import</span> <span class="nn">textwrap</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;</span>
<span class="s2">    &lt;TITLE&gt;Hello, World&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;</span>
<span class="s2">    &lt;H1&gt;Hello, World&lt;/H1&gt;</span>
<span class="s2">    &lt;P&gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quam, nisi ratione voluptatibus possimus eveniet odio iste id aperiam odit nihil provident ea a repellat consectetur repudiandae voluptas omnis placeat!&lt;/P&gt;</span>
<span class="s2">    &lt;/BODY&gt;&lt;/HTML&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">html</span><span class="p">,</span> <span class="mi">200</span>


<span class="nd">@app</span><span class="o">.</span><span class="n">after_request</span>
<span class="k">def</span> <span class="nf">set_secure_headers</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">secure_headers</span><span class="o">.</span><span class="n">flask</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;Server&quot;</span><span class="p">,</span> <span class="s2">&quot;Secure&quot;</span><span class="p">)</span>
    <span class="n">secure_cookie</span><span class="o">.</span><span class="n">flask</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;spam&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;eggs&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
<p>Finally, let’s take a look at that.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ curl -s -D - localhost:5000

HTTP/1.0 <span class="m">200</span> OK
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length: <span class="m">387</span>
Strict-Transport-Security: max-age<span class="o">=</span><span class="m">63072000</span><span class="p">;</span> includeSubdomains
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: <span class="m">1</span><span class="p">;</span> <span class="nv">mode</span><span class="o">=</span>block
X-Content-Type-Options: nosniff
Referrer-Policy: no-referrer, strict-origin-when-cross-origin
Pragma: no-cache
Expires: <span class="m">0</span>
Cache-control: no-cache, no-store, must-revalidate, max-age<span class="o">=</span><span class="m">0</span>
Server: Secure
Set-Cookie: <span class="nv">spam</span><span class="o">=</span>eggs<span class="p">;</span> <span class="nv">Expires</span><span class="o">=</span>Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">19</span>:23:57 GMT<span class="p">;</span> Secure<span class="p">;</span> HttpOnly<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> <span class="nv">SameSite</span><span class="o">=</span>Strict
Date: Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">18</span>:23:57 GMT


&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;Hello, World&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;Hello, World&lt;/H1&gt;
&lt;P&gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quam, nisi ratione voluptatibus possimus eveniet odio iste id aperiam odit nihil provident ea a repellat consectetur repudiandae voluptas omnis placeat!&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">Server</span></code> has been set to <code class="docutils literal notranslate"><span class="pre">Secure</span></code>, and there is now a <code class="docutils literal notranslate"><span class="pre">Set-Cookie</span></code> header.</p>
<p>Each header added by <code class="docutils literal notranslate"><span class="pre">secure</span></code> can be customized. I recommend <a class="reference external" href="https://secure.readthedocs.io/en/latest/index.html">reading the documentation</a> and deciding which to omit, if you feel that’s absolutely necessary.</p>
</div>
<div class="section" id="x-powered-by">
<h2>X-Powered-By<a class="headerlink" href="#x-powered-by" title="Permalink to this headline">¶</a></h2>
<p>There are some flask plugins that enable this particular header. While I am glad Flask (unlike electron) does not do this out of the box, I will say this.</p>
<p><em>Do not, under any circumstances, advertise to your users what your API runs on.</em></p>
<p><strong>Do not, under any circumstances, give potential hackers ideas on where to look for application vulnerabilities in your API</strong>.</p>
<p>Both of these are <em>stupid ideas</em>. The only reason why you would like to advertise the stack of your API within the header would be if your API
is only accessed internally, by people you absolutely trust. Even then, developer documentation and access to the code base are better ideas.
Using <code class="docutils literal notranslate"><span class="pre">X-Powered-By</span></code> should never be a good idea.</p>
</div>
<div class="section" id="httpie">
<h2><code class="docutils literal notranslate"><span class="pre">httpie</span></code><a class="headerlink" href="#httpie" title="Permalink to this headline">¶</a></h2>
<p>While <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">-s</span> <span class="pre">-D</span> <span class="pre">-</span> <span class="pre">&lt;url&gt;</span></code> solves the header visibility problem, I also recommend using <code class="docutils literal notranslate"><span class="pre">httpie</span></code> if you’re looking for a more beginner-friendly tool.</p>
<p><code class="docutils literal notranslate"><span class="pre">httpie</span></code> is installed by <code class="docutils literal notranslate"><span class="pre">pip</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">httpie</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ http localhost:5000/

HTTP/1.0 <span class="m">200</span> OK
Cache-control: no-cache, no-store, must-revalidate, max-age<span class="o">=</span><span class="m">0</span>
Content-Length: <span class="m">387</span>
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
Date: Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">18</span>:29:15 GMT
Expires: <span class="m">0</span>
Pragma: no-cache
Referrer-Policy: no-referrer, strict-origin-when-cross-origin
Server: Secure
Set-Cookie: <span class="nv">spam</span><span class="o">=</span>eggs<span class="p">;</span> <span class="nv">Expires</span><span class="o">=</span>Wed, <span class="m">11</span> Nov <span class="m">2020</span> <span class="m">19</span>:29:15 GMT<span class="p">;</span> Secure<span class="p">;</span> HttpOnly<span class="p">;</span> <span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span> <span class="nv">SameSite</span><span class="o">=</span>Strict
Strict-Transport-Security: max-age<span class="o">=</span><span class="m">63072000</span><span class="p">;</span> includeSubdomains
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: <span class="m">1</span><span class="p">;</span> <span class="nv">mode</span><span class="o">=</span>block

&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv<span class="o">=</span><span class="s2">&quot;content-type&quot;</span> <span class="nv">content</span><span class="o">=</span><span class="s2">&quot;text/html;charset=utf-8&quot;</span>&gt;
&lt;TITLE&gt;Hello, World&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;Hello, World&lt;/H1&gt;
&lt;P&gt;Lorem ipsum dolor sit amet consectetur adipisicing elit. Perferendis quam, nisi ratione voluptatibus possimus eveniet odio iste id aperiam odit nihil provident ea a repellat consectetur repudiandae voluptas omnis placeat!&lt;/P&gt;
&lt;/BODY&gt;&lt;/HTML&gt;
</pre></div>
</div>
<p>While this offers the same output, it also does this by default, and adds some nice colors to the output. Refer the documentation for more.</p>
</div>
<div class="section" id="references-and-additional-tools">
<h2>References and Additional Tools<a class="headerlink" href="#references-and-additional-tools" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p><a class="reference external" href="https://owasp.org/www-project-secure-headers/">OWASP Secure Headers Project</a></p></li>
<li><p><a class="reference external" href="https://secure.readthedocs.io/en/latest/index.html"><code class="docutils literal notranslate"><span class="pre">secure.py</span></code></a></p></li>
<li><p><a class="reference external" href="https://www.manning.com/books/secure-by-design">Secure by Design - Book on Security best practices by Manning Publications</a></p></li>
<li><p><a class="reference external" href="https://github.com/riramar/hsecscan"><code class="docutils literal notranslate"><span class="pre">hsecscan</span></code> - Python Tool to Check Headers of an API</a></p></li>
<li><p><a class="reference external" href="https://httpie.io/"><code class="docutils literal notranslate"><span class="pre">httpie</span></code> - Python Alternative for CURL</a></p></li>
<li><p><a class="reference external" href="https://github.com/OWASP/CheatSheetSeries">OWASP Cheat Sheets</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-web-security-testing-guide/v41/">OWASP Web Security Testing Guide</a></p></li>
<li><p><a class="reference external" href="https://owasp.org/www-project-top-ten/">OWASP Top 10 Web Application Security Risks</a></p></li>
</ol>
</div>
</div>

<div class="section">
    

<div class="section">
  <span style="float: left">
     
    <a href="../2020-09-01-ear-one/">
      <i class="fa fa-arrow-circle-left"></i> (Y)ear One
    </a>
    
  </span>
  <span>&nbsp;</span>
  <span style="float: right">
     
    <a href="../2020-11-16-miles-morales/">
      The Song of a Hero - Insomniac’s Spider-Man Miles Morales <i
        class="fa fa-arrow-circle-right"
      ></i
      >
    </a>
    
  </span>
</div>
  
  <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = "stonecharioteer";
      var disqus_identifier = "/posts/2020/2020-11-11-web-application-security/";
      var disqus_title = "Web Application Security with secure.py";
      var disqus_url = "https://stonecharioteer.com/posts/2020/2020-11-11-web-application-security";

      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
    <a href="https://disqus.com" class="dsq-brlink"
      >comments powered by <span class="logo-disqus">Disqus</span></a
    >
  </div>
  
</div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Vinay Keerthi.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>